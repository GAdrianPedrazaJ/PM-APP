"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const t=require("../fetch-DWXwEnoe.cjs");exports.createAPIClient=(e,s=[])=>{let a=t.createEnhancedFetch(s);return{baseURL:e,pushChainFunction:e=>{s.push(e),a=t.createEnhancedFetch(s)},uploadFiles:async(s,r)=>{const n=`${e}/files`,d=new FormData,i="undefined"!=typeof navigator&&"ReactNative"===navigator.product;void 0!==s["bucket-id"]&&d.append("bucket-id",s["bucket-id"]),void 0!==s["metadata[]"]&&s["metadata[]"].forEach((t=>{i?d.append("metadata[]",{string:JSON.stringify(t),type:"application/json",name:""}):d.append("metadata[]",new Blob([JSON.stringify(t)],{type:"application/json"}),"")})),void 0!==s["file[]"]&&s["file[]"].forEach((t=>{d.append("file[]",t)}));const o=await a(n,{...r,method:"POST",body:d});if(o.status>=300){const e=[412].includes(o.status)?null:await o.text(),s=e?JSON.parse(e):{};throw new t.FetchError(s,o.status,o.headers)}const u=[204,205,304].includes(o.status)?null:await o.text();return{body:u?JSON.parse(u):{},status:o.status,headers:o.headers}},deleteFile:async(s,r)=>{const n=`${e}/files/${s}`,d=await a(n,{...r,method:"DELETE",headers:{...r?.headers}});if(d.status>=300){const e=[412].includes(d.status)?null:await d.text(),s=e?JSON.parse(e):{};throw new t.FetchError(s,d.status,d.headers)}return{body:void 0,status:d.status,headers:d.headers}},getFile:async(s,r,n)=>{const d=r&&Object.entries(r).flatMap((([t,e])=>{const s=Array.isArray(e)?e.join(","):"object"==typeof e&&null!==e?JSON.stringify(e):String(e);return[`${t}=${encodeURIComponent(s)}`]})).join("&"),i=d?`${e}/files/${s}?${d}`:`${e}/files/${s}`,o=await a(i,{...n,method:"GET",headers:{...n?.headers}});if(o.status>=300){const e=[412].includes(o.status)?null:await o.text(),s=e?JSON.parse(e):{};throw new t.FetchError(s,o.status,o.headers)}return{body:await o.blob(),status:o.status,headers:o.headers}},getFileMetadataHeaders:async(s,r,n)=>{const d=r&&Object.entries(r).flatMap((([t,e])=>{const s=Array.isArray(e)?e.join(","):"object"==typeof e&&null!==e?JSON.stringify(e):String(e);return[`${t}=${encodeURIComponent(s)}`]})).join("&"),i=d?`${e}/files/${s}?${d}`:`${e}/files/${s}`,o=await a(i,{...n,method:"HEAD",headers:{...n?.headers}});if(o.status>=300){const e=[412].includes(o.status)?null:await o.text(),s=e?JSON.parse(e):{};throw new t.FetchError(s,o.status,o.headers)}return{body:void 0,status:o.status,headers:o.headers}},replaceFile:async(s,r,n)=>{const d=`${e}/files/${s}`,i=new FormData,o="undefined"!=typeof navigator&&"ReactNative"===navigator.product;void 0!==r.metadata&&(o?i.append("metadata",{string:JSON.stringify(r.metadata),type:"application/json",name:""}):i.append("metadata",new Blob([JSON.stringify(r.metadata)],{type:"application/json"}),"")),void 0!==r.file&&i.append("file",r.file);const u=await a(d,{...n,method:"PUT",body:i});if(u.status>=300){const e=[412].includes(u.status)?null:await u.text(),s=e?JSON.parse(e):{};throw new t.FetchError(s,u.status,u.headers)}const l=[204,205,304].includes(u.status)?null:await u.text();return{body:l?JSON.parse(l):{},status:u.status,headers:u.headers}},getFilePresignedURL:async(s,r)=>{const n=`${e}/files/${s}/presignedurl`,d=await a(n,{...r,method:"GET",headers:{...r?.headers}});if(d.status>=300){const e=[412].includes(d.status)?null:await d.text(),s=e?JSON.parse(e):{};throw new t.FetchError(s,d.status,d.headers)}const i=[204,205,304].includes(d.status)?null:await d.text();return{body:i?JSON.parse(i):{},status:d.status,headers:d.headers}},deleteBrokenMetadata:async s=>{const r=`${e}/ops/delete-broken-metadata`,n=await a(r,{...s,method:"POST",headers:{...s?.headers}});if(n.status>=300){const e=[412].includes(n.status)?null:await n.text(),s=e?JSON.parse(e):{};throw new t.FetchError(s,n.status,n.headers)}const d=[204,205,304].includes(n.status)?null:await n.text();return{body:d?JSON.parse(d):{},status:n.status,headers:n.headers}},deleteOrphanedFiles:async s=>{const r=`${e}/ops/delete-orphans`,n=await a(r,{...s,method:"POST",headers:{...s?.headers}});if(n.status>=300){const e=[412].includes(n.status)?null:await n.text(),s=e?JSON.parse(e):{};throw new t.FetchError(s,n.status,n.headers)}const d=[204,205,304].includes(n.status)?null:await n.text();return{body:d?JSON.parse(d):{},status:n.status,headers:n.headers}},listBrokenMetadata:async s=>{const r=`${e}/ops/list-broken-metadata`,n=await a(r,{...s,method:"POST",headers:{...s?.headers}});if(n.status>=300){const e=[412].includes(n.status)?null:await n.text(),s=e?JSON.parse(e):{};throw new t.FetchError(s,n.status,n.headers)}const d=[204,205,304].includes(n.status)?null:await n.text();return{body:d?JSON.parse(d):{},status:n.status,headers:n.headers}},listFilesNotUploaded:async s=>{const r=`${e}/ops/list-not-uploaded`,n=await a(r,{...s,method:"POST",headers:{...s?.headers}});if(n.status>=300){const e=[412].includes(n.status)?null:await n.text(),s=e?JSON.parse(e):{};throw new t.FetchError(s,n.status,n.headers)}const d=[204,205,304].includes(n.status)?null:await n.text();return{body:d?JSON.parse(d):{},status:n.status,headers:n.headers}},listOrphanedFiles:async s=>{const r=`${e}/ops/list-orphans`,n=await a(r,{...s,method:"POST",headers:{...s?.headers}});if(n.status>=300){const e=[412].includes(n.status)?null:await n.text(),s=e?JSON.parse(e):{};throw new t.FetchError(s,n.status,n.headers)}const d=[204,205,304].includes(n.status)?null:await n.text();return{body:d?JSON.parse(d):{},status:n.status,headers:n.headers}},getVersion:async s=>{const r=`${e}/version`,n=await a(r,{...s,method:"GET",headers:{...s?.headers}});if(n.status>=300){const e=[412].includes(n.status)?null:await n.text(),s=e?JSON.parse(e):{};throw new t.FetchError(s,n.status,n.headers)}const d=[204,205,304].includes(n.status)?null:await n.text();return{body:d?JSON.parse(d):{},status:n.status,headers:n.headers}}}};
//# sourceMappingURL=storage.cjs.map
