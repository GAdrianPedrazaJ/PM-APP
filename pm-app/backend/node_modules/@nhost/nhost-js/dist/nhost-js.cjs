"use strict";Object.defineProperty(exports,Symbol.toStringTag,{value:"Module"});const e=require("./nhost-js/auth.cjs"),s=require("./middlewareWithAdminSession-DDApoLkL.cjs"),t=require("./nhost-js/functions.cjs"),n=require("./nhost-js/graphql.cjs"),o=require("./refreshSession-Bw715ZmX.cjs"),r=require("./nhost-js/session.cjs"),i=require("./nhost-js/storage.cjs"),a=({auth:e,storage:t,graphql:n,functions:o,sessionStorage:r})=>{const i=[s.sessionRefreshMiddleware(e,r),s.updateSessionFromResponseMiddleware(r),s.attachAccessTokenMiddleware(r)];for(const s of i)e.pushChainFunction(s),t.pushChainFunction(s),n.pushChainFunction(s),o.pushChainFunction(s)},c=({auth:e,storage:t,graphql:n,functions:o,sessionStorage:r})=>{const i=[s.updateSessionFromResponseMiddleware(r),s.attachAccessTokenMiddleware(r)];for(const s of i)e.pushChainFunction(s),t.pushChainFunction(s),n.pushChainFunction(s),o.pushChainFunction(s)};class u{auth;storage;graphql;functions;sessionStorage;constructor(e,s,t,n,o){this.auth=e,this.storage=s,this.graphql=t,this.functions=n,this.sessionStorage=o}getUserSession(){return this.sessionStorage.get()}async refreshSession(e=60){return o.refreshSession(this.auth,this.sessionStorage,e)}clearSession(){this.sessionStorage.remove()}}function h(s={}){const{subdomain:o,region:a,authUrl:c,storageUrl:h,graphqlUrl:l,functionsUrl:p,storage:S=r.detectStorage(),configure:d=[]}=s,f=new r.SessionStorage(S),C=g("auth",o,a,c),q=g("storage",o,a,h),w=g("graphql",o,a,l),j=g("functions",o,a,p),F=e.createAPIClient(C),m=i.createAPIClient(q,[]),A=n.createAPIClient(w,[]),M=t.createAPIClient(j,[]);for(const e of d)e({auth:F,storage:m,graphql:A,functions:M,sessionStorage:f});return new u(F,m,A,M,f)}const g=(e,s,t,n)=>n||(s&&t?`https://${s}.${e}.${t}.nhost.run/v1`:`https://local.${e}.local.nhost.run/v1`);exports.createClient=function(e={}){const s=e.storage??r.detectStorage();return h({...e,storage:s,configure:[a,...e.configure??[]]})},exports.createNhostClient=h,exports.createServerClient=function(e){return h({...e,configure:[c,...e.configure??[]]})},exports.generateServiceUrl=g,exports.withAdminSession=function(e){return({storage:t,graphql:n,functions:o})=>{const r=s.withAdminSessionMiddleware(e);t.pushChainFunction(r),n.pushChainFunction(r),o.pushChainFunction(r)}},exports.withClientSideSessionMiddleware=a,exports.withServerSideSessionMiddleware=c;
//# sourceMappingURL=nhost-js.cjs.map
